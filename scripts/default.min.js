!function(){function a(){b.addEventListener("click",d.clickManager),window.addEventListener("popstate",function(a){d.goToPage(location)}),window.addEventListener("hashchange",function(a){c.extra="",d.updatePageStatus()}),window.addEventListener("load",function(a){window.scrollTo(0,0),d.goToPage(location),d.applySH(),d.applyComments(),d.applySocialButtons(),setTimeout(function(){d.loaded=!0}),d.setTitle()}),window.addEventListener("keyup",function(a){switch(a.keyCode){case 27:d.closeModal(),b.classList.remove("see-all-articles")}})}var b=document.body,c={},d={};d.XHR={obj:new XMLHttpRequest,askFor:function(a,b){var c=d.XHR.obj;c.onreadystatechange=function(){4==c.readyState&&b(c.responseText,200==c.status)},c.open("GET",a,!0),c.send(null)}},d.showContent=function(a,b,e){c={page:a,detail:b,extra:e},d.updatePageStatus()},d.clickManager=function(a){var e,f=a.target||a.srcElement,g=f.tagName.toLowerCase(),h=f.classList,i="#";if("a"==g&&h.contains("local")){if(h.contains("inactive"))return a.preventDefault(),a.stopPropagation(),!1;i=f.getAttribute("href"),e=i.replace("/","").split("/"),d.showContent(e[0],e[1],e[2]),a.preventDefault(),a.stopPropagation()}else if((e=f.getAttribute("data-yt-ref"))||(e=f.parentNode.getAttribute("data-yt-ref")))c.extra=e,d.videoBg=f.getAttribute("src")||f.firstElementChild.getAttribute("src"),d.updatePageStatus();else if(h.contains("closeLayerBtn"))d.closeModal();else if(h.contains("art-nav-tbn"))if(h.contains("art-tools")){var j=document.getElementById("articles-nav");"tools"!=j.getAttribute("data-show")?(j.setAttribute("data-show","tools"),b.classList.remove("see-all-articles")):j.removeAttribute("data-show")}else if(h.contains("art-see-list"))b.classList.toggle("see-all-articles");else{var j=document.getElementById("the-article"),k=parseInt(j.getAttribute("data-text-size"));switch(f.id){case"article-tool-bigger":4>k&&(k++,j.setAttribute("data-text-size",k));break;case"article-tool-smaller":k>1&&(k--,j.setAttribute("data-text-size",k));break;case"article-tool-contrast":"on"==j.getAttribute("data-contrast")?j.setAttribute("data-contrast","off"):j.setAttribute("data-contrast","on")}}},d.showPlayer=function(a){var b=document.getElementById("playerLayer"),c=document.getElementById("playerElement");b.style.backgroundImage="url("+a.bg+")",c.style.backgroundImage="url("+a.bg+")",c.setAttribute("src","//www.youtube.com/embed/"+a.ytRef+"?showinfo=0")},d.closePlayer=function(){document.getElementById("playerElement").removeAttribute("src")},d.showModal=function(a){switch(a.type){case"player":d.showPlayer(a)}b.setAttribute("data-full-layer",a.type),d.registerPageView()},d.closeModalLayer=function(){var a=b.getAttribute("data-full-layer");switch(a){case"player":d.closePlayer()}b.removeAttribute("data-full-layer"),d.registerPageView()},d.closeModal=function(){c.extra=!1,d.updatePageStatus()},d.setArticlesLoadStatus=function(a){a>=100?(d.articlesloader.style.width="120%",setTimeout(function(){d.articlesContainer.innerHTML=d.tmpContainer.querySelector("section").innerHTML,d.tmpContainer.innerHTML="",d.applySH(),d.applyComments(),d.applySocialButtons(),d.registerPageView()},400)):d.articlesloader.style.width=a+"%"},d.loadArticleAsync=function(a){var c,e,f=0;d.tmpContainer=d.tmpContainer||document.getElementById("articleTmpElement"),d.articlesContainer=d.articlesContainer||document.getElementById("articles-container"),d.articlesloader=document.getElementById("loading-bar"),d.setArticlesLoadStatus(30),b.classList.remove("see-all-articles"),d.XHR.askFor("/articles/"+a+"/index-ajax.html",function(a,b){d.setArticlesLoadStatus(60),b&&(d.tmpContainer.innerHTML=a,c=[].slice.call(d.tmpContainer.querySelectorAll("img")),e=function(){f++,f>=c.length-1&&d.setArticlesLoadStatus(100)},c.length?c.forEach(function(a){a.onload=a.onerror=e}):e())})},d.applySH=function(){Prism.highlightAll()},d.applyComments=function(){if(d.disqusApplied)DISQUS.reset({reload:!0});else{d.disqusApplied=!0;var a="felipenmoura";!function(){var b=document.createElement("script");b.type="text/javascript",b.async=!0,b.src="//"+a+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(b)}()}},d.updatePageStatus=function(){c.page?b.setAttribute("data-page",c.page):b.setAttribute("data-page","home"),"articles"==c.page&&c.detail?d.loaded&&d.loadArticleAsync(c.detail):(b.classList.remove("see-all-articles"),document.getElementById("articles-nav").removeAttribute("data-show")),("videos"==c.detail||"labs"==c.detail)&&c.extra?d.showModal({type:"player",bg:d.videoBg||"",ytRef:c.extra}):d.closeModalLayer(),c.detail?b.setAttribute("hash-bang-detail",c.detail):b.removeAttribute("hash-bang-detail"),c.extra?b.setAttribute("hash-bang-extra",c.extra):b.removeAttribute("hash-bang-extra");var a="/"+(c.page||"");c.detail&&(a+="/"+c.detail),c.extra?a+="/#"+c.extra:a.match(/\/$/)||(a+="/"),d.registerPageView(),location.pathname+(location.hash||"#")!=a+(c.extra||"#")&&(history.pushState({},a,a),d.setTitle())},d.setTitle=function(){var a="felipenmoura: "+(c.page||"home");c.detail&&(a+=" | "+c.detail),c.extra&&(a+=" | "+c.extra),document.title=a},d.registerPageView=function(){ga("send","pageview",{page:location.pathname+location.search+location.hash})},d.goToPage=function(a){a=a||location;var b=a.pathname;b=b.split("/"),b.length?(c.page=b[1],c.detail=b[2],c.extra=location.hash.replace("#",""),d.updatePageStatus()):(c={},d.updatePageStatus())},d.applpiedSocialButtons=!1,d.applySocialButtons=function(){d.applpiedSocialButtons?(twttr.widgets.load(),FB.XFBML.parse(document.body)):(!function(a,b,c){var d,e=a.getElementsByTagName(b)[0],f=/^http:/.test(a.location)?"http":"https";a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src=f+"://platform.twitter.com/widgets.js",e.parentNode.insertBefore(d,e))}(document,"script","twitter-wjs"),function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.3&appId=427975900560419",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk")),function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://apis.google.com/js/platform.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}(),d.applpiedSocialButtons=!0},a(),d.goToPage(location)}();