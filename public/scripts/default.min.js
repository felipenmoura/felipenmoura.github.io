!function(){var e=document.body,t={},a={};a.XHR={obj:new XMLHttpRequest,askFor:function(e,t){var i=a.XHR.obj;i.onreadystatechange=function(){4==i.readyState&&t(i.responseText,200==i.status)},i.open("GET",e,!0),i.send(null)}},a.showContent=function(e,i,n){t={page:e,detail:i,extra:n},a.updatePageStatus()},a.clickManager=function(i){var n,o=i.target||i.srcElement,s=o.tagName.toLowerCase(),r=o.classList;if("a"==s&&r.contains("local")){if(r.contains("inactive"))return i.preventDefault(),i.stopPropagation(),!1;n=o.getAttribute("href").replace("/","").split("/"),a.showContent(n[0],n[1],n[2]),i.preventDefault(),i.stopPropagation()}else if((n=o.getAttribute("data-yt-ref"))||(n=o.parentNode.getAttribute("data-yt-ref")))t.extra=n,a.videoBg=o.getAttribute("src")||o.firstElementChild.getAttribute("src"),a.updatePageStatus();else if(r.contains("closeLayerBtn"))a.closeModal();else if(r.contains("art-nav-tbn"))if(r.contains("art-tools"))"tools"!=(l=document.getElementById("articles-nav")).getAttribute("data-show")?(l.setAttribute("data-show","tools"),e.classList.remove("see-all-articles")):l.removeAttribute("data-show"),a.registerEvent("button","click","Article tools");else if(r.contains("art-see-list"))e.classList.toggle("see-all-articles"),a.registerEvent("button","click","See all articles");else{var l=document.getElementById("the-article"),c=parseInt(l.getAttribute("data-text-size"));switch(o.id){case"article-tool-bigger":c<4&&(c++,l.setAttribute("data-text-size",c),a.registerEvent("button","click","Font Size UP - Article tools",c));break;case"article-tool-smaller":c>1&&(c--,l.setAttribute("data-text-size",c),a.registerEvent("button","click","Font Size DOWN - Article tools",c));break;case"article-tool-contrast":"on"==l.getAttribute("data-contrast")?(l.setAttribute("data-contrast","off"),a.registerEvent("button","click","Contrast - Article tools","off")):(l.setAttribute("data-contrast","on"),a.registerEvent("button","click","Contrast - Article tools","on"))}}else o.parentNode.classList.contains("utils-thumb")&&a.registerEvent("button","click","Opened an image",o.getAttribute("src"))},a.showPlayer=function(e){var t=document.getElementById("playerLayer"),i=document.getElementById("playerElement");t.style.backgroundImage="url("+e.bg+")",i.style.backgroundImage="url("+e.bg+")",i.setAttribute("src","//www.youtube.com/embed/"+e.ytRef+"?showinfo=0"),a.registerEvent("button","click","Watch video",e.ytRef)},a.closePlayer=function(){document.getElementById("playerElement").removeAttribute("src")},a.showModal=function(t){switch(t.type){case"player":a.showPlayer(t)}e.setAttribute("data-full-layer",t.type),a.registerPageView()},a.closeModalLayer=function(){switch(e.getAttribute("data-full-layer")){case"player":a.closePlayer()}e.removeAttribute("data-full-layer"),a.registerPageView()},a.closeModal=function(e){t.extra=!1,a.updatePageStatus(),e?a.registerEvent("key","press","Close modal","Used the ESC key"):a.registerEvent("button","click","Close modal","Used the mouse or touch")},a.setArticlesLoadStatus=function(e){e>=100?(a.articlesloader.style.width="120%",setTimeout(function(){a.articlesContainer.innerHTML=a.tmpContainer.querySelector("section").innerHTML,a.tmpContainer.innerHTML="",a.applySH(),a.applyComments(),a.applySocialButtons(),a.registerPageView()},400)):a.articlesloader.style.width=e+"%"},a.loadArticleAsync=function(t){var i,n,o=0;a.tmpContainer=a.tmpContainer||document.getElementById("articleTmpElement"),a.articlesContainer=a.articlesContainer||document.getElementById("articles-container"),a.articlesloader=document.getElementById("loading-bar"),a.setArticlesLoadStatus(30),e.classList.remove("see-all-articles"),a.XHR.askFor("/articles/"+t+"/index-ajax.html",function(e,t){a.setArticlesLoadStatus(60),t&&(a.tmpContainer.innerHTML=e,i=[].slice.call(a.tmpContainer.querySelectorAll("img")),n=function(){++o>=i.length-1&&a.setArticlesLoadStatus(100)},i.length?i.forEach(function(e){e.onload=e.onerror=n}):n())})},a.applySH=function(){if(window.Prism)Prism.highlightAll();else{var e=document.createElement("script");e.async=!0,e.defer=!0,e.src="/sh/prism.js",e.onload=function(){window.Prism&&a.applySH()};var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href="/sh/prism.min.css",document.body.appendChild(t),document.body.appendChild(e)}},a.applyComments=function(){console.log("Applying DISQUS");var e=document.getElementById("disqus_thread").getAttribute("data-article-url");window.disqus_url="http://felipenmoura.com"+e+"/",window.disqus_identifier=window.disqus_url,a.disqusApplied?DISQUS.reset({reload:!0,config:function(){this.page.identifier=window.disqus_identifier,this.page.url=window.disqus_url}}):setTimeout(function(){console.log("Applying disqus"),a.disqusApplied=!0;!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0,e.src="//felipenmoura.disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()},5e3)},a.updatePageStatus=function(){t.page?e.setAttribute("data-page",t.page):e.setAttribute("data-page","home"),"articles"==t.page&&t.detail?a.loaded&&a.loadArticleAsync(t.detail):(e.classList.remove("see-all-articles"),document.getElementById("articles-nav").removeAttribute("data-show")),("videos"==t.detail||"labs"==t.detail)&&t.extra?a.showModal({type:"player",bg:a.videoBg||"",ytRef:t.extra}):a.closeModalLayer(),t.detail?e.setAttribute("hash-bang-detail",t.detail):e.removeAttribute("hash-bang-detail"),t.extra?e.setAttribute("hash-bang-extra",t.extra):e.removeAttribute("hash-bang-extra");var i="/"+(t.page||"");t.detail&&(i+="/"+t.detail),t.extra?i+="/#"+t.extra:i.match(/\/$/)||(i+="/"),a.registerPageView(),location.pathname+(location.hash||"#")!=i+(t.extra||"#")&&(history.pushState({},i,i),a.setTitle()),"articles"!==t.page&&"artigos"!==t.page||a.applyComments()},a.setTitle=function(){var e=t.page||"home";t.detail&&(e+=" | "+t.detail),t.extra&&(e+=" | "+t.extra),document.title=e.replace(/\-/g," ")+" | Felipe N. Moura"},a.registerPageView=function(){ga("send","pageview",{page:location.pathname+location.search+location.hash})},a.registerEvent=function(e,a,i,n){ga("send","event",e,a,i,n||1,{page:[t.page,t.detail,t.extra].filter(function(e){return e}).join("/")})},a.goToPage=function(e){var i=(e=e||location).pathname;(i=i.split("/")).length?(t.page=i[1],t.detail=i[2],t.extra=location.hash.replace("#",""),a.updatePageStatus()):(t={},a.updatePageStatus())},a.applpiedSocialButtons=!1,a.applySocialButtons=function(){},e.addEventListener("click",a.clickManager),window.addEventListener("popstate",function(e){a.goToPage(location)}),window.addEventListener("hashchange",function(e){t.extra="",a.updatePageStatus()}),window.addEventListener("load",function(e){window.scrollTo(0,0),a.goToPage(location),a.applySH(),a.applySocialButtons(),setTimeout(function(){a.loaded=!0}),a.setTitle()}),window.addEventListener("keyup",function(t){switch(t.keyCode){case 27:a.closeModal(!0),e.classList.remove("see-all-articles")}}),a.goToPage(location)}();